model:
  sequence_len: 128
  n_head: 4
  n_kv_head: 4
  n_embd: 128
  n_layer: 4
  
  # Recursive configuration
  recursive: true
  recursion_depth: 5
  

  share_kv: false
  share_kv_n_layers: 0
  use_adaptive_computation: false
  n_layers_per_block: 1
  max_pondering_steps: 5
  act_threshold: 0.99
  halting_penalty: 0.001


data:
  dataset_name: "AddMul"
  num_samples: 100_000_000
  max_operands: 5
  max_digits: 5
  operations: ["+", "*"]
  seed: 0
  eval_seed: 40


optimizer:
  unembedding_lr: 0.0005
  embedding_lr: 0.0005
  matrix_lr: 0.0005
  halting_lr: 0.0005
  weight_decay: 0.0


training:
  batch_size: 256
  num_workers: 0
  steps: 150000
  log_every: 100
  eval_every: 5000
  eval_n_samples: 500
  warmup_steps: 2000
  gradient_clip: 1.0
  seed: 42


wandb:
  enabled: true
  project: "DL-project"
  entity: null  
  name: null  
  tags: ["act", "synthetic_task", "language-modeling"]
  notes: "DL-project exp ACT"


checkpoint:
  save_dir: "checkpoints/recursive"
  save_final: true
  final_name: "final_model_recursive.pt"
